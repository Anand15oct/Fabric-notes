SELECT 
  CS_USERS_B1.OPRID AS USER_ID,
  CS_USERS_B1.OPRDEFNDESC AS USERNAME,
  CS_USERS_B1.EMPLID AS USER_EMPLOYEE_ID,
  CS_USERS_B1.OPRCLASS AS PL_PRIMARY_CODE,
  CS_USERS_B1.ROWSECCLASS AS ROW_SECURITY_CODE,
  CS_USERS_B1.PRCSPRFLCLS AS PROCESS_PROFILE_CODE,
  CS_USERS_B1.DEFAULTNAVHP AS NAVIG_HOMEPAGE_CODE,
  DATE_FORMAT(CS_USERS_B1.LASTPSWDCHANGE, 'yyyy-MM-dd') AS LAST_PASSWORD_CHANGE,
  CASE WHEN CS_USERS_B1.ACCTLOCK = 0 THEN 'No' ELSE 'Yes' END AS ACCOUNT_LOCKED,
  CS_USERS_B1.FAILEDLOGINS AS FAILED_LOGINS,
  CASE WHEN CS_USERS_B1.EXPENT = 0 THEN 'No' ELSE 'Yes' END AS PASSWORD_EXPIRED,
  DATE_FORMAT(CS_USERS_B1.LASTSIGNONDTTM, 'yyyy-MM-dd') AS LAST_LOGIN_DATE,
  DATE_FORMAT(CS_USERS_B1.LASTUPDDTTM, 'yyyy-MM-dd') AS DATE_UPDATED,
  CS_USERS_B1.LASTUPDOPRID AS LAST_UPDATED_USER_ID,
  COALESCE((SELECT EMAIL_ADDR FROM UOM_OWNER.PS_UM_EMAIL_TBL WHERE EMPLID = CS_USERS_B1.EMPLID LIMIT 1), NULL) AS USER_EMAIL,
  CS_USERS_B1.CLASSDEFNDESC AS PL_PRIM_DESC,
  CS_USERS_B1.CLASSDEFNDESC_1 AS PL_ROW_SECURITY_DESC,
  CS_USERS_B1.CLASSDEFNDESC_2 AS PL_PROCESS_PROFILE_DESC,
  CS_USERS_B1.CLASSDEFNDESC_3 AS PL_NAVIG_HOMEPAGE_DESC,
  DATE_FORMAT(DATE_SUB(CURRENT_DATE, CS_USERS_B1.LASTSIGNONDTTM), 'yyyy-MM-dd') AS DAYS_SINCE_LAST_LOGIN,
  COALESCE(PSROLEUSER.ROLENAME, NULL) AS ROLE_ID,
  COALESCE((SELECT STAFF_FLAG FROM UOM_OWNER.ICC_ALL_STAFF_CS_SEC WHERE EMPLOYEE_NUMBER = CS_USERS_B1.EMPLID LIMIT 1), NULL) AS STAFF_FLAG,
  COALESCE((SELECT LEAVER_FLAG FROM UOM_OWNER.ICC_ALL_STAFF_CS_SEC WHERE EMPLOYEE_NUMBER = CS_USERS_B1.EMPLID LIMIT 1), NULL) AS LEAVER_FLAG,
  COALESCE((SELECT CURRENT_STAFF_FLAG FROM UOM_OWNER.ICC_ALL_STAFF_CS_SEC WHERE EMPLOYEE_NUMBER = CS_USERS_B1.EMPLID LIMIT 1), NULL) AS CURRENT_STAFF_FLAG,
  COALESCE((SELECT STAFF_LEAVING_DATE FROM UOM_OWNER.ICC_ALL_STAFF_CS_SEC WHERE EMPLOYEE_NUMBER = CS_USERS_B1.EMPLID LIMIT 1), NULL) AS STAFF_LEAVING_DATE,
  COALESCE((SELECT FACULTY_CODE FROM UOM_OWNER.ICC_ALL_STAFF_CS_SEC WHERE EMPLOYEE_NUMBER = CS_USERS_B1.EMPLID LIMIT 1), NULL) AS FACULTY_CODE,
  COALESCE((SELECT FACULTY_DESCR FROM UOM_OWNER.ICC_ALL_STAFF_CS_SEC WHERE EMPLOYEE_NUMBER = CS_USERS_B1.EMPLID LIMIT 1), NULL) AS FACULTY_DESCR,
  COALESCE((SELECT LEVEL_3_CODE FROM UOM_OWNER.ICC_ALL_STAFF_CS_SEC WHERE EMPLOYEE_NUMBER = CS_USERS_B1.EMPLID LIMIT 1), NULL) AS LEVEL_3_CODE,
  COALESCE((SELECT LEVEL_3_DESCR FROM UOM_OWNER.ICC_ALL_STAFF_CS_SEC WHERE EMPLOYEE_NUMBER = CS_USERS_B1.EMPLID LIMIT 1), NULL) AS LEVEL_3_DESCR,
  COALESCE((SELECT LEVEL_4_CODE FROM UOM_OWNER.ICC_ALL_STAFF_CS_SEC WHERE EMPLOYEE_NUMBER = CS_USERS_B1.EMPLID LIMIT 1), NULL) AS LEVEL_4_CODE,
  COALESCE((SELECT LEVEL_4_DESCR FROM UOM_OWNER.ICC_ALL_STAFF_CS_SEC WHERE EMPLOYEE_NUMBER = CS_USERS_B1.EMPLID LIMIT 1), NULL) AS LEVEL_4_DESCR,
  COALESCE((SELECT LAST_POST_HOLDING_CHANGE_DT FROM UOM_OWNER.ICC_ALL_STAFF_CS_SEC WHERE EMPLOYEE_NUMBER = CS_USERS_B1.EMPLID LIMIT 1), NULL) AS LAST_POST_HOLDING_CHANGE_DT,
  COALESCE((SELECT STAFF_ACCESS_AFTER_LEAVE FROM UOM_OWNER.ICC_ALL_STAFF_CS_SEC WHERE EMPLOYEE_NUMBER = CS_USERS_B1.EMPLID LIMIT 1), NULL) AS STAFF_ACCESS_AFTER_LEAVE,
  COALESCE((SELECT 'Y' FROM UOM_OWNER.STUDENT_PROGRAM_FC_SR WHERE PROGRAM_STATUS = 'AC' AND EMPLID = CS_USERS
